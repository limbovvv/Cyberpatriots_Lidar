# WebGL-редактор облаков точек — руководство по использованию

Веб-приложение для загрузки и редактирования облаков точек: просмотр, удаление или восстановление точек и экспорт обновлённых данных.

## Структура проекта
- `app/backend` — FastAPI-приложение, работа с БД SQLite и файловым хранилищем тайлов и экспортов.
- `app/frontend` — Vite + React UI для просмотра облака, инструментов маски и экспорта.
- `app/infra` — вспомогательные файлы для контейнеризации и прокси.
- `data` — локальное хранилище SQLite и загруженных данных (создаётся при запуске).

## Минимальное использование
1. Установите Python 3.11+ и Node.js 18+.
2. Создайте виртуальное окружение и установите зависимости бекенда:
   ```bash
   python -m venv .venv
   source .venv/bin/activate
   pip install -r app/backend/requirements.txt
   ```
3. Запустите API:
   ```bash
   uvicorn app.backend.main:app --reload --port 8000
   ```
4. В отдельном терминале установите зависимости фронтенда и запустите dev-сервер:
   ```bash
   cd app/frontend
   npm install
   npm run dev
   ```
5. Откройте http://localhost:5173 и следуйте подсказкам интерфейса.

## Backend и API
- API доступно по `http://localhost:8000`. Для фронтенда проксируется через `/api` (можно переопределить `VITE_API_BASE`).
- Основной сценарий:
  - `POST /datasets/upload` — загрузка PCD-файла и запуск тайлинга (поддерживаются `DATA ascii`, `DATA binary`, `DATA binary_compressed`).
  - `GET /datasets/{id}/tiles` — получение списка тайлов для визуализации.
  - `POST /datasets/{id}/sessions` и `PATCH /datasets/{id}/sessions/{sessionId}/ops` — фиксирование операций удаления/восстановления.
  - `POST /datasets/{id}/export` — сборка обновлённого `processed_points.pcd` и `GET /datasets/{id}/export` для скачивания.
- База данных по умолчанию — `data/app.db` (SQLite). Загруженные файлы и тайлы складываются в `data/{dataset_id}`.

## Frontend
- Dev-сервер доступен по http://localhost:5173 и автоматически обращается к API.
- Интерфейс позволяет:
  - загрузить датасет и дождаться завершения тайлинга;
  - просматривать тайлы через 3D-вьюер и перемещаться по сцене;
  - применять маску удаления/восстановления с фиксированием в выбранной сессии;
  - запросить экспорт и скачать обновлённый PCD.
- При необходимости подключить другой сервер — задайте `VITE_API_BASE` перед запуском `npm run dev`.
